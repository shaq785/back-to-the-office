var tileHeight=83,tileWidth=101,finalScore=450,Global=function(e,t,s,i,a){this.x=e,this.y=t,this.sprite=s,this.animationIndex=i,void 0===i&&(this.animationIndex=0),this.blockWidth=a};function shuffle(e){let t,s=e.length;for(;0!=s;)t=Math.floor(Math.random()*s),s--,[e[s],e[t]]=[e[t],e[s]];return e}var Enemy=function(e,t,s,i){var a=Math.floor((550-t)/500*250);Global.call(this,e,t,s,1,i),this.canvasrow=tileWidth,this.limit=7*this.canvasrow,this.speed=a};Enemy.prototype.start=function(){this.canvasrow=tileWidth,this.limit=7*this.canvasrow},Enemy.prototype.update=function(e){directionRow=this.y,directionRow%2==0?this.x>-this.limit?this.x-=this.speed*e:this.x=707:(this.start(),this.x<this.limit?this.x+=this.speed*e:this.x=-707)},Enemy.prototype.render=function(){directionRow=this.y,directionRow%2==0?ctx.drawImage(Resources.get(this.sprite[0]),this.x,this.y):ctx.drawImage(Resources.get(this.sprite[1]),this.x,this.y)},Enemy.prototype.animate=function(e){var t=[],s=0,i=this;function a(t){i.animationIndex=e[t][0]}for(var o in e)t[s]=setTimeout(a,e[o][1],s),s++};var Player=function(e,t,s,i){this.canvasrow=tileWidth,this.canvascol=tileHeight,Global.call(this,3*this.canvasrow,6*this.canvascol+55,s,this.animationIndex,1),this.win=!1,this.deathAnimate=!1,this.winAnimate=!1,this.soundPlayed=!1,this.score=0,this.lives=3,this.gameOver=!1,$("#livescount").text(this.lives),$("#scoreBar").text(this.score)};Player.prototype.start=function(){this.x=303,this.y=553,this.lives=3,this.score=0,$("#livescount").text(this.lives),$("#scoreBar").text(this.score)},Player.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite[this.animationIndex]),this.x,this.y)},Player.prototype.animate=function(e){var t=[],s=0,i=this;function a(t){i.animationIndex=e[t][0]}for(var o in e)t[s]=setTimeout(a,e[o][1],s),s++},Player.prototype.update=function(){this.score>=finalScore&&0==this.soundPlayed&&(this.soundPlayed=!0,console.log(this.soundPlayed),document.getElementById("doorSound").play());-28===this.y&&this.x===3*tileWidth&&this.score>=finalScore&&(this.winAnimate=!0,this.x=303,this.y=55,this.animate([[0,0],[3,500],[5,1e3],[4,1500],[5,2001]]),document.getElementById("themeSong").pause(),document.getElementById("winSound").play(),setTimeout(()=>{this.win=!0,this.winAnimate=!1,this.reset(),this.score+=5,$("#scoreBar").text(this.score),this.gameOver=!1,this.x=303,this.y=553,$("#winModal").modal("show"),console.log(this.score,"Score"),this.gameOver=!0,this.start()},4e3))},Player.prototype.checkCollisions=function(e){for(var t of allEnemies)if(this.y===t.y&&t.x<this.x+this.canvasrow/2&&t.x+t.canvasrow*t.blockWidth/2>this.x){this.deathAnimate=!0,this.animate([[1,0],[4,500],[1,1e3],[4,1500],[0,2001]]);var s=["collisionSound-1","collisionSound-2","collisionSound-3","collisionSound-4","collisionSound-5"];shuffle(s);var i=s[0];console.log(i),document.getElementById(i).play(),setTimeout(()=>{this.deathAnimate=!1,this.reset(),this.score-=5,this.lives-=1,$("#livescount").text(this.lives),$("#scoreBar").text(this.score),0===this.lives&&($("#gameoverModal").modal("show"),console.log(this.score,"Score"),$(".tw").attr("href","https://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.millenniumweb.com%2F2021-holiday%2F&via=millennium&text=I%20just%20scored%20a%20"+this.score+"&hashtags=millhastag"),this.gameOver=!0,this.start())},2e3)}else this.update()},Player.prototype.handleInput=function(e){switch(e){case"left":this.animate([[2,0],[0,250]]),this.x>0&&(this.x-=this.canvasrow);break;case"right":this.animate([[3,0],[0,250]]),this.x<6*this.canvasrow&&(this.x+=this.canvasrow);break;case"up":this.score<finalScore?this.y>1*this.canvascol&&(this.y-=this.canvascol):this.y>0&&(this.y-=this.canvascol);break;case"down":this.animate([[4,0],[0,250]]),this.y<6*this.canvascol&&(this.y+=this.canvascol)}},Player.prototype.reset=function(){this.x=3*this.canvasrow,this.y=6*this.canvascol+55};var Gems=function(e,t,s,i){Global.call(this,Math.floor(Math.random()*e),t,s,this.animationIndex,1),this.posx=e,this.canvascol=tileHeight,this.canvasrow=tileWidth,this.limit=7*this.canvasrow,this.speed=Math.floor(150*Math.random()),this.animationClock=10,this.animationClockDefault=this.animationClock};Gems.prototype.restart=function(){this.x=Math.floor(Math.random()*this.posx)},Gems.prototype.start=function(){this.canvasrow=tileWidth,this.limit=7*this.canvasrow,this.speed=Math.floor(250*Math.random())},Gems.prototype.update=function(e){directionRow=this.y,directionRow%2==0?this.x>-this.limit?this.x-=this.speed*e:this.x=707:(this.start(),this.x<this.limit?this.x+=this.speed*e:this.x=-707)},Gems.prototype.checkGems=function(e){if(this.y===player.y&&player.x<this.x+this.canvasrow/2&&player.x+player.canvasrow/2>this.x){player.animate([[5,0],[0,250]]);var t=["gemSound-1","gemSound-2","gemSound-3","gemSound-4","gemSound-5","gemSound-6"];shuffle(t);var s=t[0];document.getElementById(s).play(),"images/boost-coffee1.svg"===this.sprite[0]?(this.x=900,player.score+=20,$("#scoreBar").text(player.score)):"images/boost-mask1.svg"===this.sprite[0]?(this.x=900,player.score+=30,$("#scoreBar").text(player.score)):"images/boost-vaccine1.svg"===this.sprite[0]?(this.x=900,player.score+=40,$("#scoreBar").text(player.score)):"images/Rock.png"===this.sprite[0]&&(this.x=900,player.score-=50,player.reset(),$("#scoreBar").text(player.score))}},Gems.prototype.render=function(){this.animationClock-=1,0==this.animationClock&&(this.animationClock=this.animationClockDefault,this.animationIndex+=1,this.animationIndex>this.sprite.length-1&&(this.animationIndex=0)),ctx.drawImage(Resources.get(this.sprite[this.animationIndex]),this.x,this.y)},Gems.prototype.animate=function(e){var t=[],s=0,i=this;function a(t){i.animationIndex=e[t][0]}for(var o in e)t[s]=setTimeout(a,e[o][1],s),s++};var enemy1=new Enemy(-100,138,["images/cars1.svg","images/cars1-right.svg"],1),enemy2=new Enemy(-900,138,["images/bus.svg","images/bus-right.svg"],2),enemy3=new Enemy(0,221,["images/cars2.svg","images/cars2-right.svg"],1),enemy4=new Enemy(-450,221,["images/truck.svg","images/cars1-right.svg"],1),enemy5=new Enemy(-404,304,["images/protestors1.svg","images/protestors1.svg"],2),enemy6=new Enemy(-101,304,["images/protestors2.svg","images/protestors2.svg"],1),enemy7=new Enemy(-350,387,["images/covid.svg","images/covid.svg"],1),enemy8=new Enemy(0,387,["images/covid.svg","images/covid.svg"],1),enemy9=new Enemy(-400,470,["images/clothes1.svg","images/clothes1.svg"],1),enemy10=new Enemy(-100,470,["images/clothes2.svg","images/clothes2.svg"],1),enemy11=new Enemy(-50,55,["images/mask-ordinance1.svg","images/mask-ordinance1.svg"],1),enemy12=new Enemy(-600,55,["images/mask-ordinance2.svg","images/mask-ordinance2.svg"],1),allEnemies=[enemy1,enemy2,enemy3,enemy4,enemy5,enemy6,enemy7,enemy8,enemy9,enemy10,enemy11,enemy12];console.log(allEnemies);var player=new Player(0,0,["images/character-back.svg","images/character-death.svg","images/character-left.svg","images/character-right.svg","images/character-default.svg","images/character-win.svg"]),coffeeFrames=["images/boost-coffee1.svg","images/boost-coffee2.svg","images/boost-coffee3.svg","images/boost-coffee4.svg"],maskFrames=["images/boost-mask1.svg","images/boost-mask2.svg","images/boost-mask3.svg","images/boost-mask4.svg"],vaccineFrames=["images/boost-vaccine1.svg","images/boost-vaccine2.svg","images/boost-vaccine3.svg","images/boost-vaccine4.svg"],gem1=new Gems(-50,138,coffeeFrames),gem2=new Gems(-200,221,maskFrames),gem3=new Gems(-350,304,vaccineFrames),gem4=new Gems(-450,387,maskFrames),gem5=new Gems(-500,470,coffeeFrames),allGems=[gem1,gem2,gem3,gem4,gem5];document.addEventListener("DOMContentLoaded",(function(){$("#welcomeModal").modal("show")})),$("#btplay").click((function(){allGems.forEach((function(e){e.restart()}))})),document.addEventListener("keyup",(function(e){player.deathAnimate||player.handleInput({37:"left",38:"up",39:"right",40:"down"}[e.keyCode])}));var mobileBtn=document.getElementsByClassName("keys"),mobileKeyQuery=document.querySelectorAll("[data-key]");for(let e=0;e<mobileBtn.length;e++)mobileBtn[e].addEventListener("click",(function(t){var s=mobileKeyQuery[e].dataset.key,i=parseInt(s);player.deathAnimate||player.handleInput({37:"left",38:"up",39:"right",40:"down"}[i])}));